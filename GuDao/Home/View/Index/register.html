<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title></title>
<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/common/bootstrap.css">
<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/common/common.css">
<link rel="stylesheet" type="text/css" href="__PUBLIC__/css/common/frame.css">
<script type="text/javascript" src="__PUBLIC__/js/common/jquery-3.2.1.js"></script>
<script type="text/javascript" src="__PUBLIC__/js/common/jquery.validate.js"></script>
<script type="text/javascript" src="__PUBLIC__/js/common/bootstrap.js"></script>
<script type="text/javascript" src="__PUBLIC__/js/common/vue.js"></script>

<style>
.content {
	height: -webkit-calc(100% - 41px);
	height: -moz-calc(100% - 41px);
	height: -ms-calc(100% - 41px);
	height: -o-calc(100% - 41px);
	height: calc(100% - 41px);
}


.left {
	display: inline-block;
	width: 49%;
	height: 100%;
	border-right: 1px solid #ffd700;
}
.left img {
    display: block;
    width: 12%;
	margin: 50% auto 0;
    -webkit-transform: translateY(-50%);
    -moz-transform: translateY(-50%);
    -ms-transform: translateY(-50%);
    -o-transform: translateY(-50%);
    transform: translateY(-50%);
}
.right {
	display: inline-block;
	width: 50%;
	vertical-align: top;
}

.right form {
	width: 50%;
	margin: 50% auto 0;
    -webkit-transform: translateY(-50%);
    -moz-transform: translateY(-50%);
    -ms-transform: translateY(-50%);
    -o-transform: translateY(-50%);
    transform: translateY(-50%);
}
.right form div.input {
	/*width: 100%;
	margin-top: -1px;
	padding: 0.8rem 1rem;
	border-top: 1px solid #ffd700;
	border-bottom: 1px solid #ffd700;*/
	font-size: 0;
}
.right form div.input span {
	color: #333;
	font-size: 2.4rem;
	vertical-align: middle;
}
.right form div.input input {
	width: -webkit-calc(100% - 2.4rem);
	width: -moz-calc(100% - 2.4rem);
	width: -ms-calc(100% - 2.4rem);
	width: -o-calc(100% - 2.4rem);
	width: calc(100% - 2.4rem);
	padding-left: 1rem;
	margin-top: 3px;
	color: #f2f2f2;
	font-size: 1.6rem;
	vertical-align: middle;
}
.right form div.code input{
	
	width: calc(100% - 10rem);
}
.right form div.code button.getCode{
	display: inline-block;
	height:18px;
	font-size: 1.6rem;
	border: none;
	background: none;
}
.right form .signUpBtn {
	margin-top: 3rem;
	width: 100%;
	padding: 0.8rem 0;
	font-size: 1.6rem;
}
</style>
</head>
<body>

<div id="gudao">	
	<!-- 导航条 -->
	<navbar></navbar>

	<!-- 内容 -->
	<div class="container content">
		<div class="left">
			<img src="__PUBLIC__/img/index/register.png">
		</div>
		<div class="right">
			<form id="signUp">
					<div class="input">
							<span class="glyphicon glyphicon-envelope"></span>
							<input type="email" name="email" placeholder="邮箱" autocomplete="off" v-model="email">
					</div>
					<div class="input code">
							<span class="glyphicon glyphicon-ok-circle"></span>
							<input type="text" maxlength="6" name="code" placeholder="验证码" autocomplete="off" v-model="code">
							<button class="getCode">获取验证码</button>
					</div>
					<div class="input">
							<span class="glyphicon glyphicon-lock"></span>
							<input type="password" name="password" placeholder="密码" autocomplete="off" v-model="password">
					</div>
					<div class="input">
							<span class="glyphicon glyphicon-lock"></span>
							<input type="password" name="passwordCheck" placeholder="确认密码" autocomplete="off" v-model="passwordCheck">
					</div>
					<button class="signUpBtn">注册</button>
			</form>
		</div>
	</div>

	<!-- 底部 -->
	<back-to-top></back-to-top>
	<copyright></copyright>
</div>


<script type="text/javascript" src="__PUBLIC__/js/common/common.js"></script>
<script type="text/javascript" src="__PUBLIC__/js/common/component.js"></script>
<script type="text/javascript" src="__PUBLIC__/js/common/frame.js"></script>

<script>
new Vue({
	el: '#gudao',
	data:{
		email:"",
		code:"",
		password:"",
		passwordCheck:""
	},
	components: {
		"navbar": navbar,
		"back-to-top": backToTop,
		"copyright": copyright
	}
});
$(function() {
	var obj = {
			form: {							// 必选，对象，获取验证码的表单设置
				targetType: "email",				// 可选，字符串，目标类型，取值为"phone"或"email"，默认为"phone"
				inputName: "email",				// 可选，字符串，填写手机号码或邮箱地址的input标签的name属性值，默认为"phone"
				// getCodeClass: "getCode",			// 可选，字符串，获取验证码按钮的button标签的class，默认为"getCode"
				// countdown: 60,				// 可选，数值，重新获取验证码的等待时间，默认为60
				// countdownText: ""			// 可选，字符串，等待重新获取验证码时按钮的文本内容，默认为"重新发送"
			},
			ajax: {							// 必选，对象，获取验证码的ajax设置
				url: "sendCode",					// 必选，字符串，获取验证码的请求地址
				// type: "",					// 可选，字符串，请求方式，默认为"POST"
				// dataType: "",				// 可选，字符串，返回的数据类型，默认为"json"
				// dataName: "",				// 可选，字符串，发送给服务器的数据对象中名值对的名，默认为填写手机号码或邮箱地址的input标签的name属性值
				// resultCodeName: "",			// 可选，字符串，返回数据的状态码名称，默认为"code"
				// resultMsgName: "",			// 可选，字符串，返回数据的消息名称，默认为"msg"
				successCode: "200"				// 可选，字符串或数值，返回数据的成功状态码，使用严格比较运算符进行比较，默认为1
			},
			alertBox: {						// 可选，对象，弹窗显示获取验证码的结果，不弹窗显示时可访问全局变量getCodeMsg以获取ajax返回信息
				className: "text",				// 可选，字符串，弹窗额外的类名
				close: true,				// 可选，布尔值，是否有关闭按钮，默认为false
				title: "孤岛提示",					// 可选，字符串，标题文本，默认无标题
				// buttons: [{					// 可选，数组，默认为一个“确定”按钮
				// 	value: "",				// 必选，字符串，按钮文本
				// 	callback: function() {}	// 可选，函数，点击按钮的回调函数，默认操作为关闭弹窗
				// }]
			}
		}
	getCode(obj);

	$("#signUp").validate({
		debug: true,
		rules: {
			email: {
				required: true,
				email: true
			},
			code:{
				required:true,
				digits:true,
				maxlength:4
			},
			password: {
				required: true
			},
			passwordCheck:{
				equalTo:"[name='password']"
			}
		},
		messages: {
			email: {
				required: "请输入邮箱",
				email: "邮箱格式有误"
			},
			code:{
				required:"请输入验证码",
				digits:"请输入数字",
				maxlength:"请输入四位数字"
			},
			password:{
				required: "请输入密码"
			},
			passwordCheck:{
				equalTo:"两次密码输入不一致"
			}
		},
		submitHandler:function(){
			var email = $("[name='email']").val();
			var code = $("[name=code]").val();
			var password = $("[name=password]").val();
			$.ajax({
				url:"doRegister",
				type:"POST",
				dataTpye:"json",
				data:{
					email:email,
					code:code,
					password:password
				},
				success:function(result){
					if (result.code === 200){
						location.href="home"
					}
					else if (result.code === 201 && result.msg === "登录失败"){
						setAlertBox({
							className: "text",
							close: true,
							title: "孤岛提示",
							message: "登录失败",
							buttons: [{
								value: "确定",
								callback: function() {
									location.href="login"
								}
							}]
						})
					}
					else {
						setAlertBox({
							className: "text",
							close: true,
							title: "孤岛提示",
							message: result.msg,
							buttons: [{
								value: "确定"
							}]
						})
					}
				}
			})

		}
	});
	// $.ajax({
	// 	url: "__URL__/doRegister",
	// 	type: "POST",
	// 	dataType: "json",
	// 	data: {
	// 		"email": "ng.winglam@qq.com",
	// 		"code": 1234,
	// 		"password": md5("wuyinglin123"),
	// 		"autoLogin": true
	// 	},
	// 	success: function(result) {
	// 		console.log(result);
	// 	}
	// });
});
</script>

</body>
</html>